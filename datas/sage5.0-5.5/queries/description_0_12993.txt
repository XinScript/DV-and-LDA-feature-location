Trac #12993: #12993: Bug in computing the rank function a poset
Trac #12993: #12993: Bug in computing the rank function a poset

This patch fixes a current bug in poset in sage.
The following should return True:

sage: P = Poset(([1,2,3,4],[[1,4],[2,3],[3,4]]), facade = True)
sage: P.is_graded()
False

Anne's suggestion from this  thread on sage-combinat-devel:

    For a finite poset perhaps the easiest would be to

    start with a random element in the poset, assign rank 0
    look at all covers and cocovers and assign the rank according to the recurrence rank(x) = rank(y) + 1 if x covers y.
    repeat with the new elements
    if at any point an element is reached again and is assigned a different value from before, the poset is not graded; otherwise continue with new elements

Darij implemented this.
