Trac #13665: extra improvements to the patch
Trac #13665: extra improvements to the patch
